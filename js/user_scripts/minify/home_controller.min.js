"use strict";milesApp.controller("homeCtrl",["$scope","$rootScope","$window","$timeout","$sce","items","services","$routeParams","PageTitle","$location",function(t,e,o,i,a,n,s,l,r,u){function p(){return{h:g.height(),w:g.width()}}function c(){m=g.width(),h=g.height();var e=angular.element(".holder_conteudo").width()*d/_;i.cancel(t.resize_timeout),t.resize_timeout=i(function(){angular.element(".video_holder").height(e)},250)}t.posts=n.posts,t.total_posts=n.total_posts,t.total_posts_act=t.posts.length,0==t.total_posts_act&&l.url_post&&(o.location.href=e.lang+"/all"),t.$on("$viewContentLoaded",function(){o.ga("send","pageview",{page:u.url()})}),l.url_post?(r.setTitle("5TMiles -"+t.posts[0].titulo),r.setDesc(t.posts[0].texto.substring(0,160))):(r.setTitle("5TMiles"),r.setDesc(e.lang_array.descricao_page)),angular.forEach(t.posts,function(t){angular.forEach(t.media,function(o){1==o.id_tipo&&(o.media=a.trustAsHtml('<iframe width="100%" height="100%" src="'+o.media+'" frameborder="0" allowfullscreen></iframe>')),4==o.id_tipo&&(o.media=a.trustAsHtml(e.pathgeral+"posts/"+t.id+"/"+o.media))})}),t.vidorimg=function(t){return 1==t.id_tipo||2==t.id_tipo},t.audiofile=function(t){return 3==t.id_tipo||4==t.id_tipo},t.play_audio=function(t,e){t.playing?(t.audio.pause(),t.playing=!1):(t.audio=new Audio(e),t.audio.play(),t.playing=!0)};var _=1080,d=610,g=angular.element(o),m=0,h=0;t.resize_timeout,t.$watch(p,function(){c()},!0),g.bind("resize",function(){t.$apply()}),t.get_more_posts=function(){angular.element(".get_more_button").addClass("get_more_button_loading");var o=s.get_posts(e.array_tags,t.total_posts_act,8,t.lang);o.then(function(e){angular.forEach(e.posts,function(e){t.posts.push(e)}),t.total_posts_act=t.posts.length,angular.element(".get_more_button").removeClass("get_more_button_loading")},function(t){console.log("Failed: "+t)})}}]);